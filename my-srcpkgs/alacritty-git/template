build_style=cargo
conflicts=alacritty
depends="libXxf86vm ncurses"
homepage="https://github.com/jwilm/alacritty"
hostmakedepends="fontconfig-devel freetype-devel git libxcb-devel pkg-config python3"
license="Apache-2.0"
maintainer="Orphaned <orphan@voidlinux.org>"
my_field_repo=git://github.com/jwilm/alacritty
my_field_skip_version=5651c3f
pkgname=alacritty-git
provides=alacritty-0_1
revision=1
short_desc="Cross-platform, GPU-accelerated terminal emulator"
version=cc33bec

alacritty-git_package() {
    true
}

do_fetch() {
    git clone $my_field_repo ${pkgname}-${version}
}

do_install() {
    cargo install --path alacritty --target ${RUST_TARGET} --root="${DESTDIR}/usr"
    rm "${DESTDIR}"/usr/.crates.toml
}

post_install() {
    vinstall extra/linux/alacritty.desktop 644 usr/share/applications
    vinstall extra/logo/alacritty-term.svg 644 usr/share/pixmaps Alacritty.svg
    vinstall extra/completions/alacritty.bash 644 usr/share/bash-completion/completions alacritty
    vinstall extra/completions/_alacritty 644 usr/share/zsh/site-functions
    vinstall extra/completions/alacritty.fish 644 usr/share/fish/completions
    vinstall extra/alacritty.info 644 usr/share/terminfo/a
    vman extra/alacritty.man alacritty.1
    vsconf alacritty.yml
}
